---
title: "confounders"
author: "Maggie Li (ml4424)"
date: "2/15/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(janitor)
```

Population Density Data; downloaded from US Census 

```{r}
census_pop_density <- read.csv("Data/census_2010_pop_density.csv")
head(census_pop_density)

#keep columns GCT_STUB.target.geo.id2, HD01, SUBHD0401, SUBHD0402 (population and housing density)
census_pop_density <- census_pop_density %>% subset(select = c(GCT_STUB.target.geo.id2,
                                                               HD01,
                                                               SUBHD0401, 
                                                               SUBHD0402,
                                                               GCT_STUB.display.label.1))
#delete first three rows
census_pop_density <- census_pop_density[-c(1,2,3),]
census_pop_density <- census_pop_density %>% 
  dplyr::rename(County = GCT_STUB.target.geo.id2) %>%
  dplyr::rename(total_pop = HD01) %>%
  dplyr::rename(pop_density = SUBHD0401) %>%
  dplyr::rename(housing_density = SUBHD0402) %>% 
  dplyr::rename(County_name = GCT_STUB.display.label.1)

census_pop_density$County <- as.numeric(as.character(census_pop_density$County))
census_pop_density <- census_pop_density %>%
  filter(County <= 56045) %>% 
  filter(County > 1000)  #filter out territories
census_pop_density 
# clean county column by adding leading zero
county_cleaned <- formatC(census_pop_density$County, width = 5, format = "d", flag = "0")

census_pop_density <- cbind(census_pop_density, county_cleaned) %>%
  dplyr::select(-County)

census_pop_density$county_cleaned<- as.factor(census_pop_density$county_cleaned) 
census_pop_density <- census_pop_density %>% dplyr::rename(County = county_cleaned)

census_pop_density

# filter california 
cali_pop_density = census_pop_density %>% 
  filter(str_detect(County, "^06"))

# write_csv(cali_pop_density, "./data/cali_pop_density.csv")
```

Temperature data

```{r}
# NOAA National Climate Data Center, "Climate at a Glance", county-level mapping
# month selected is the last month in the time scale
# summer average temperature, years 2011-2018, all counties (to check specific months)
# https://www.ncdc.noaa.gov/cag/county/mapping/4/pcp/201702/7/value

temp_2011 <- read_csv("./data/temp_2011.csv", col_names = TRUE) %>% 
  mutate(year = 2011)
temp_2012 <- read_csv("./data/temp_2012.csv", col_names = TRUE) %>% 
  mutate(year = 2012)
temp_2013 <- read_csv("./data/temp_2013.csv", col_names = TRUE) %>% 
  mutate(year = 2013)
temp_2014 <- read_csv("./data/temp_2014.csv", col_names = TRUE) %>% 
  mutate(year = 2014)
temp_2015 <- read_csv("./data/temp_2015.csv", col_names = TRUE) %>% 
  mutate(year = 2015)
temp_2016 <- read_csv("./data/temp_2016.csv", col_names = TRUE) %>% 
  mutate(year = 2016)
temp_2017 <- read_csv("./data/temp_2017.csv", col_names = TRUE) %>% 
  mutate(year = 2017)
temp_2018 <- read_csv("./data/temp_2018.csv", col_names = TRUE) %>% 
  mutate(year = 2018)


avg_summer_temp <- rbind(temp_2011, temp_2012, temp_2013, temp_2014, temp_2015,
                         temp_2016, temp_2017, temp_2018)

# write_csv(avg_summer_temp, "./data/avg_summer_temp.csv")

```

